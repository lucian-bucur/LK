---
- debug: var=master.meta[0]
- uri:
    url: "https://{{ master.meta[0] }}:30443/master/relays/{{ item }}/logging_server"
    method: GET
    validate_certs: no
  register: logging_server
  delegate_to: "{{ master.meta[0] }}"
- debug: var=logging_server.json['logging_server']

- name: "register logging filter dictionaries"
  set_fact:
      logging_filters: "{{ logging_filters | combine({ item: logging_server.json['logging_server'] }) }}"

- uri:
    url: "https://{{ master.meta[0] }}:30443/master/archive/options/{{ item }}/active"
    method: GET
    status_code: [200,404]
    validate_certs: no
  register: active_status
  delegate_to: "{{ master.meta[0] }}"

- name: "register archive options dictionaries when status == 200"
  set_fact:
      archive_options: "{{ archive_options | combine({ item: active_status.json.active }) }}"
  when: active_status.status == 200

- name: "register archive options dictionaries when status != 200"
  set_fact:
      archive_options: "{{ archive_options | combine({ item: 0 }) }}"
  when: active_status.status != 200
